(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{"3GUV":function(e,t,r){"use strict";r("7x/C"),r("Blm6"),r("OZaJ"),r("DZ+c");var n=r("VrFO"),a=r.n(n),o=r("Y9Ll"),i=r.n(o),c=r("5Yy7"),l=r.n(c),s=r("N+ot"),u=r.n(s),d=r("AuHH"),p=r.n(d),f=r("ERkP"),h=r("rHpw"),m=r("MWbm");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return u()(this,r)}}var g=function(e){l()(r,e);var t=b(r);function r(){return a()(this,r),t.apply(this,arguments)}return i()(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return f.createElement(m.a,{style:v.root})}}]),r}(f.Component),v=h.a.create((function(e){return{root:{height:"".concat(5*parseInt(e.lineHeight,10),"rem")}}}));t.a=g},"5UID":function(e,t,r){"use strict";r("7x/C"),r("OZaJ"),r("DZ+c");var n=r("VrFO"),a=r.n(n),o=r("Y9Ll"),i=r.n(o),c=r("5Yy7"),l=r.n(c),s=r("N+ot"),u=r.n(s),d=r("AuHH"),p=r.n(d),f=r("ERkP"),h=r("3XMw"),m=r.n(h),b=r("rHpw"),g=(r("aWzz"),r("+/1j")),v=r("MWbm");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return u()(this,r)}}var E=m.a.e5b0063d,O=0,_=function(e){l()(r,e);var t=y(r);function r(){var e;return a()(this,r),(e=t.call(this))._listDomId="accessible-list-".concat(O),O+=1,e}return i()(r,[{key:"render",value:function(){var e=this.props,t=e.children,r=e.title,n=E({title:r});return f.createElement(v.a,{accessibilityRole:"region","aria-labelledby":this._listDomId},f.createElement(g.a,{accessibilityRole:"heading","aria-level":1,nativeID:this._listDomId,style:b.a.visuallyHidden},r),f.createElement(v.a,{accessibilityLabel:n},t))}}]),r}(f.Component);t.a=_},Avzu:function(e,t,r){"use strict";r("1t7P"),r("LW0h"),r("jwue"),r("daRM"),r("FtHn"),r("+KXO"),r("+oxZ");var n=r("KEM+"),a=r.n(n),o=r("ERkP"),i=r("Lsrn"),c=r("k/Ka");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c.a)("svg",s(s({},e),{},{style:[i.a.root,e.style],viewBox:"0 0 24 24"}),o.createElement("g",null,o.createElement("path",{d:"M23.25 3.25h-2.425V.825c0-.414-.336-.75-.75-.75s-.75.336-.75.75V3.25H16.9c-.414 0-.75.336-.75.75s.336.75.75.75h2.425v2.425c0 .414.336.75.75.75s.75-.336.75-.75V4.75h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-3.175 6.876c-.414 0-.75.336-.75.75v8.078c0 .414-.337.75-.75.75H4.095c-.412 0-.75-.336-.75-.75V8.298l6.778 4.518c.368.246.79.37 1.213.37.422 0 .844-.124 1.212-.37l4.53-3.013c.336-.223.428-.676.204-1.012-.223-.332-.675-.425-1.012-.2l-4.53 3.014c-.246.162-.563.163-.808 0l-7.586-5.06V5.5c0-.414.337-.75.75-.75h9.094c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H4.096c-1.24 0-2.25 1.01-2.25 2.25v13.455c0 1.24 1.01 2.25 2.25 2.25h14.48c1.24 0 2.25-1.01 2.25-2.25v-8.078c0-.415-.337-.75-.75-.75z"})))};u.metadata={width:24,height:24},t.a=u},BUB3:function(e,t,r){"use strict";r("1t7P"),r("LW0h"),r("jwue"),r("daRM"),r("FtHn"),r("+KXO"),r("+oxZ");var n=r("KEM+"),a=r.n(n),o=r("m3Bd"),i=r.n(o),c=r("ERkP"),l=r("sNn6"),s=r("rHpw"),u=r("MWbm");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=s.a.create((function(e){return{activeRoot:{backgroundColor:e.colors.faintGray},overlay:p(p({},s.a.absoluteFillObject),{},{borderRightStyle:"solid",borderRightWidth:e.borderWidths.medium,borderRightColor:e.colors.primary,zIndex:1})}}));t.a=function(e){var t=e.children,r=i()(e,["children"]);return c.createElement(l.a,r,(function(e){return c.createElement(u.a,{style:[e&&f.activeRoot]},"function"==typeof t?t(e):t,e?c.createElement(u.a,{pointerEvents:"none",style:f.overlay}):null)}))}},TEoO:function(e,t,r){"use strict";var n=r("m3Bd"),a=r.n(n),o=r("ERkP"),i=r("5UID"),c=r("3GUV"),l=r("iBK2"),s=o.createElement(c.a,null),u=function(e){var t=e.accessibilityTitle,r=a()(e,["accessibilityTitle"]),n=o.createElement(l.b,r);return t?o.createElement(i.a,{title:t},n):n};u.defaultProps={footer:s},t.a=u},fuhe:function(e,t,r){"use strict";r.r(t),r.d(t,"DMDrawer",(function(){return vt}));r("2G9S"),r("7x/C"),r("OZaJ"),r("DZ+c"),r("3voH");var n=r("97Jx"),a=r.n(n),o=r("VrFO"),i=r.n(o),c=r("Y9Ll"),l=r.n(c),s=r("1Pcy"),u=r.n(s),d=r("5Yy7"),p=r.n(d),f=r("N+ot"),h=r.n(f),m=r("AuHH"),b=r.n(m),g=r("KEM+"),v=r.n(g),y=r("ERkP"),E=r("ZUOq"),O=r("MMRb"),_=r("rxPX"),w=r("0KEI"),I=r("RqPI"),C=Object(_.a)().propsFromState((function(){return{conversations:O.selectConversations,drawerExperimentEnabled:O.selectDrawerExperimentEnabled,perspective:I.g,poppedOutConversationId:O.selectPoppedOutConversationId,visibility:O.selectDrawerVisibility}})).propsFromActions((function(){return{createLocalApiErrorHandler:Object(w.d)("DIRECT_MESSAGES_CONVERSATION"),fetchInboxIfNeeded:O.fetchInboxIfNeeded,loadDrawerExperimentFromPersistence:O.loadDrawerExperimentFromPersistence,loadDrawerVisibilityFromPersistence:O.loadDrawerVisibilityFromPersistence,setDrawerVisibility:O.setDrawerVisibility}})),x=(r("z84I"),r("1t7P"),r("LW0h"),r("jwue"),r("lTEL"),r("daRM"),r("FtHn"),r("+KXO"),r("+oxZ"),r("kYxP"),r("VnFT")),D=r("1YZw"),P=r("hqKg"),S=r("Myq3"),j=r("AQOc"),M=r("UhuB"),R=r("l0YN"),H=r("G6rE"),k=r("P1r1");function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(e,t){return t.conversationId},L=Object(P.createSelector)((function(e,t){return O.selectEntriesForConversation(e,F(0,t))}),I.g,(function(e,t){return t?function(e,t){var r=Object(S.a)(e,(function(e){return!!e.message_data&&(e.message_data&&e.message_data.recipient_id===t)}));return r&&r.message_data&&r.message_data.quick_reply&&r.message_data.quick_reply&&"options"===r.message_data.quick_reply.type?r.message_data.quick_reply:void 0}(e,t):void 0})),A=function(e){return function(t){return x.c(e,t)}},U=function(e){return function(t,r){return x.a(e,t,r)}},B={conversation:function(e,t){return O.selectConversation(e,F(0,t))},entries:O.selectEntries,perspective:I.g,users:H.e.selectAll,dataSaverMode:k.j,dtabBarInfo:k.l,quickReplyOptions:L,visibility:O.selectDrawerVisibility,inboxUnreadCount:R.a,isUnread:function(e,t){return!O.selectConversationIsRead(e,F(0,t))},isDmReceiptSettingEnabled:M.j},W={draftText:function(e,t){return x.m(e,F(0,t))},gifMetadata:function(e,t){return x.h(e,F(0,t))},isUploading:function(e,t){return x.j(e,F(0,t))},media:function(e,t){return x.i(e,F(0,t))},mediaMetadata:function(e,t){return x.k(e,F(0,t))},mediaUploadProgress:function(e,t){return x.l(e,F(0,t))}},V=Object(_.a)().propsFromState((function(){return N(N({},B),W)})).adjustStateProps((function(e){var t=e.conversation,r=e.entries,n=e.perspective,a=e.users,o=e.dataSaverMode,i=e.draftText,c=e.dtabBarInfo,l=e.gifMetadata,s=e.inboxUnreadCount,u=e.isDmReceiptSettingEnabled,d=e.isUploading,p=e.isUnread,f=e.media,h=e.mediaMetadata,m=e.mediaUploadProgress,b=e.quickReplyOptions,g=e.visibility,v=null==t?void 0:t.data;return{conversation:v&&Object(j.a)(v,r,a),perspective:n,dataSaverMode:o,draftText:i,dtabBarInfo:c,gifMetadata:l,inboxUnreadCount:s,isDmReceiptSettingEnabled:u,isUploading:d,isUnread:p,media:f,mediaMetadata:h,mediaUploadProgress:m,quickReplyOptions:b,visibility:g}})).propsFromActions((function(e){var t=e.conversationId;return{addMedia:U(t),addToast:D.b,createLocalApiErrorHandler:Object(w.d)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:O.fetchConversationHistory,removeMedia:A(t),saveText:x.f,sendMessage:x.n,updateConversationReadState:O.updateConversationReadState,updateTyping:O.updateTyping,fetchUpdatesIfNeeded:O.fetchUpdatesIfNeeded}})).withAnalytics({page:"messages",section:"thread_drawer"}),G=r("aWyx"),$=r("qz2E"),z=(r("uB9N"),r("Oi4X")),q=r("OhSZ"),K=(r("uFXj"),Object(_.a)().propsFromState((function(){return{visibility:O.selectDrawerVisibility}})).propsFromActions((function(){return{popOutConversation:O.popOutConversation,setDrawerVisibility:O.setDrawerVisibility}})).withAnalytics()),X=r("xPna"),Z=r("wrlS"),Y=r("3XMw"),Q=r.n(Y),J=r("OrGc"),ee=r("hACr"),te=r("MWbm"),re=r("/yvb"),ne=r("Znyr"),ae=r("t62R"),oe=r("xKuM"),ie=r("rHpw"),ce=r("95Se"),le=r("Avzu"),se=r("Lsrn"),ue=r("k/Ka");function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ue.a)("svg",pe(pe({},e),{},{style:[se.a.root,e.style],viewBox:"0 0 24 24"}),y.createElement("g",null,y.createElement("path",{d:"M12 19.344l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 19.344z"}),y.createElement("path",{d:"M12 11.535l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 11.535z"})))};fe.metadata={width:24,height:24};var he=fe;function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ue.a)("svg",be(be({},e),{},{style:[se.a.root,e.style],viewBox:"0 0 24 24"}),y.createElement("g",null,y.createElement("path",{d:"M12 4.656l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0L12 4.656z"}),y.createElement("path",{d:"M12 12.465l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0l8.72-8.72z"})))};ge.metadata={width:24,height:24};var ve=ge,ye=r("hOZg"),Ee=r("x0mb");function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var _e=Q.a.a2f8105f,we=Q.a.e839db39,Ie=Q.a.d227d19e,Ce=Q.a.c64c1883,xe=Q.a.j7d0e835,De=Q.a.b08821f3,Pe=Q.a.e736990a,Se=function(e){p()(r,e);var t=Oe(r);function r(e){var n;return i()(this,r),n=t.call(this,e),v()(u()(n),"_headerBar",y.createRef()),v()(u()(n),"_isExpanded",(function(){return n.props.visibility===X.a.EXPANDED})),v()(u()(n),"_renderLeftControl",(function(){var e=n.props.inboxUnreadCount;return y.createElement(te.a,null,y.createElement(re.a,{accessibilityLabel:De,icon:y.createElement(ce.a,null),onPress:n._handleUnpopConvo,type:"text"}),e&&e>0?y.createElement(ne.a,{pip:!0,style:je.newMessagePip,truncatedCountFormatter:function(){return""},unreadCountLabel:function(){return""}}):null)})),v()(u()(n),"_renderRightControl",(function(){var e=n.props,t=e.conversationTitle,r=e.isHighlighted,a=e.hasNewMessages,o=n._isExpanded(),i=r&&a?"invertedText":"text";return y.createElement(te.a,{style:je.rightControls},t?null:y.createElement(re.a,{accessibilityLabel:Ce,icon:y.createElement(le.a,null),onPress:n._handleNewMessage,type:i}),o?y.createElement(re.a,{accessibilityLabel:Ie,icon:y.createElement(he,null),onPress:n._handleToggleVisibility,type:i}):y.createElement(re.a,{accessibilityLabel:xe,icon:y.createElement(ve,null),onPress:n._handleToggleVisibility,type:i}),n._showDMQuickAccessWithClose?y.createElement(re.a,{accessibilityLabel:we,icon:y.createElement(ye.a,null),onPress:n._handleClose,type:i}):null)})),v()(u()(n),"_handleUnpopConvo",(function(){(0,n.props.popOutConversation)(null)})),v()(u()(n),"_handleToggleVisibility",(function(){var e=n.props,t=e.analytics,r=e.setDrawerVisibility,a=e.onDrawerOpen,o=n._isExpanded()?X.a.COLLAPSED:X.a.EXPANDED;o===X.a.COLLAPSED?t.scribe({action:"collapse"}):o===X.a.EXPANDED&&(t.scribe({action:"expand"}),a&&a()),r(o)})),v()(u()(n),"_handleToggleVisibilityKeyboard",(function(){n._handleToggleVisibility(),n._headerBar&&n._headerBar.current&&n._headerBar.current.focus()})),v()(u()(n),"_handleClose",(function(){var e=n.props,t=e.analytics,r=e.setDrawerVisibility;t.scribe({action:"close"}),r(X.a.CLOSED)})),v()(u()(n),"_handleNewMessage",(function(){var e=n.props,t=e.analytics,r=e.history;t.scribe({section:"compose_drawer",component:"dm",action:"show"}),r.push({pathname:"/messages/compose",state:{source:"drawer"}})})),v()(u()(n),"_renderTitle",(function(){var e=n.props,t=e.conversationTitle,r=e.hasNewMessages,a=e.isHighlighted,o=t||y.createElement(ae.c,null,_e);return y.createElement(te.a,{style:je.titleContainer},y.createElement(te.a,{style:[je.titleTextRoot,a&&r?je.titleTextHighlighted:null]},o),r?y.createElement(te.a,{style:je.newMessageDotContainer},y.createElement(Ee.a,{accessibilityLabel:Pe,style:[je.newMessageDotRoot,a?je.newMessageDotHighlighted:je.newMessageDotRegular]})):null)})),n._showDMQuickAccessWithClose=Z.b.isTrue("responsive_web_dm_quick_access_with_close_enabled"),n}return l()(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.hasNewMessages,n=t.isHighlighted,a=t.triggerHighlight;e.isHighlighted||n||e.hasNewMessages||!r||a&&a()}},{key:"render",value:function(){var e=this.props,t=e.conversationTitle,r=e.conversationSubtitle,n=e.hasNewMessages,a=e.isHighlighted,o=n?a?[je.headerHighlighted]:[je.headerActive]:[],i=this._isExpanded();return y.createElement(ee.a,{enabled:!0,handlers:v()({},J.d.toggleDMDrawer,this._handleToggleVisibilityKeyboard)},y.createElement(te.a,{ref:this._headerBar,style:[je.headerRoot,!i&&je.headerBorderClosed].concat(o,[je.cursor,{zIndex:1}])},y.createElement(oe.a,{leftControl:t&&this._isExpanded()?this._renderLeftControl():null,onMiddleControlClick:this._handleToggleVisibility,rightControl:this._renderRightControl(),subtitle:r,title:this._renderTitle(),withBackground:!1})))}}]),r}(y.Component),je=ie.a.create((function(e){return{root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderColor:e.colors.borderColor,borderWidth:e.borderWidths.small,marginRight:e.spaces.medium,width:E.a.columnWidths.secondary.normal},cursor:{cursor:"pointer"},expanded:{height:E.a.columnWidths.secondary.normal},headerRoot:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderColor:e.colors.borderColor,borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,transition:"all 0.3s ease"},headerBorderClosed:{borderColor:e.colors.navigationBackground},headerActive:{backgroundColor:e.colors.unreadCellBackground},headerHighlighted:{borderColor:e.colors.primary,backgroundColor:e.colors.primary},titleContainer:{alignItems:"center",display:"flex",flexDirection:"row",flexGrow:1},titleTextRoot:{flexGrow:1,flexShrink:1},titleTextHighlighted:{color:e.colors.white},newMessageDotContainer:{flexGrow:1},newMessageDotRoot:{width:e.spaces.xSmall,height:e.spaces.xSmall,marginLeft:e.spaces.xxSmall},newMessageDotRegular:{color:e.colors.primary},newMessageDotHighlighted:{color:e.colors.white},newMessagePip:{right:e.spaces.xxSmall,top:e.spaces.xxSmall},rightControls:{flexDirection:"row"}}})),Me=K(Se),Re=r("aWzz"),He=r("XnpN"),ke=(r("JtPf"),r("zb92")),Te=Object(ke.a)({loader:function(){return Promise.all([r.e(11),r.e(180)]).then(r.bind(null,"Z+oW"))}}),Ne=r("GSsg"),Fe=r("aITJ"),Le=r("yrzJ");function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var Ue=function(e){p()(r,e);var t=Ae(r);function r(e){var n;return i()(this,r),n=t.call(this,e),v()(u()(n),"_composer",y.createRef()),v()(u()(n),"_renderConversation",(function(e,t){var r=n.props,a=r.conversationId,o=r.history,i=r.location;return y.createElement(z.a,{conversationId:a,history:o,isWide:!1,location:i,richTextInputContext:e,typeaheadWrapper:t})})),v()(u()(n),"_isExpanded",(function(){return n.props.visibility===X.a.EXPANDED})),v()(u()(n),"_fetchUpdatesIfNeeded",(function(){var e=n.props,t=e.conversationId,r=e.createLocalApiErrorHandler;(0,e.fetchUpdatesIfNeeded)(e.isDmReceiptSettingEnabled?{active_conversation_id:t,dm_users:!0}:{}).catch(r())})),Object($.a)(),n}return l()(r,[{key:"componentDidMount",value:function(){this._updatePolling()}},{key:"componentDidUpdate",value:function(e){e.visibility!==this.props.visibility&&this._updatePolling()}},{key:"render",value:function(){var e=this,t=this.props,r=t.conversation,n=t.perspective,a=t.history,o=t.isUnread,i=t.inboxUnreadCount,c=t.isHeaderHighlighted,l=t.onDrawerOpen,s=t.triggerHeaderHighlight,u=this._isExpanded(),d=c?"white":"normal",p=c?"white":"deepGray",f=r&&r.type===G.a.ONE_TO_ONE&&n&&Object(He.a)(r,n).map((function(e){return e.user.screen_name})),h=f?y.createElement(Le.a,{color:p,screenName:f[0]}):void 0;return y.createElement(y.Fragment,null,y.createElement(Me,{conversationSubtitle:h,conversationTitle:y.createElement(q.b,{conversation:r,perspective:n,textColor:d,withScreenName:!1}),hasNewMessages:o,history:a,inboxUnreadCount:i,isHighlighted:c,onDrawerOpen:l,triggerHighlight:s}),u?Fe.a.isDesktopOS()?y.createElement(Te,null,(function(t){var r=t.richTextInputContext,n=t.typeaheadWrapper;return e._renderConversation(r,n)})):this._renderConversation():null)}},{key:"_updatePolling",value:function(){this._pollingTimer&&this._pollingTimer.stop(),this.props.visibility===X.a.COLLAPSED&&(this._pollingTimer=new Ne.a(this._fetchUpdatesIfNeeded,{interval:3e3}),this._pollingTimer.start())}},{key:"getChildContext",value:function(){return{getCustomLocation:null}}}]),r}(y.Component);v()(Ue,"childContextTypes",{getCustomLocation:Re.func});var Be=V(Ue),We=(r("i4UL"),r("tQbP"),r("1IsZ"),r("4q8G")),Ve=r("kGix"),Ge=r("tn7R"),$e=Object(_.a)().propsFromState((function(){return{fetchStatus:O.selectFetchStatus,conversations:O.selectConversations,isLoadingTop:O.selectIsLoadingTop,settings:k.f,unreadCount:R.a,untrustedConversationCount:O.selectUntrustedConversationCount,untrustedUnreadCount:O.selectUntrustedUnreadCount,visibility:O.selectDrawerVisibility}})).adjustStateProps((function(e){var t=e.fetchStatus,r=e.conversations,n=e.isLoadingTop,a=e.settings,o=e.unreadCount,i=e.untrustedConversationCount,c=e.untrustedUnreadCount,l=e.visibility,s=!!Object.values(r).length,u=Object(Ge.a)(r).filter((function(e){var t;return!e.isDeleted&&(null===(t=e.data)||void 0===t?void 0:t.trusted)})).map((function(e){return e.data})).sort(We.a),d=o>0;return{allowUntrustedInbox:"all"===a.allow_dms_from||i>0,conversationIds:u.map((function(e){return e.conversation_id})),fetchStatus:s?Ve.a.LOADED:t,isRefreshing:s&&n,isUnread:d,untrustedUnreadCount:c,visibility:l}})).propsFromActions((function(){return{createLocalApiErrorHandler:Object(w.d)("DIRECT_MESSAGES_INBOX"),fetchInbox:O.fetchInbox,fetchInboxHistory:O.fetchTrustedInboxHistory,fetchInboxIfNeeded:O.fetchInboxIfNeeded,fetchUpdates:O.fetchUpdatesIfNeeded,updateLastSeenEventId:O.updateTrustedLastSeenEventId,popOutConversation:O.popOutConversation}})).withAnalytics({page:"messages",section:"inbox_drawer"}),ze=r("Fz18"),qe=r("qS4/"),Ke=r("B4fe"),Xe=r("yw4N"),Ze=r("FIs5"),Ye=r("csss");function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var tt=Q.a.a2f8105f,rt=Q.a.b8aa3744,nt=Q.a.j06309e1,at=Q.a.gee5150a,ot=Q.a.cf2d1047,it=Q.a.da2f9224,ct=Q.a.h6beb5fa,lt=Object(ze.b)(),st=function(e){p()(r,e);var t=et(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),v()(u()(e),"_renderExpandedInbox",(function(){var t=e.props,r=t.analytics,n=t.conversationIds,a=t.createLocalApiErrorHandler,o=t.fetchInbox,i=t.fetchInboxHistory,c=t.fetchInboxIfNeeded,l=t.fetchStatus,s=t.fetchUpdates,u=t.isRefreshing,d=t.updateLastSeenEventId;return y.createElement(te.a,{style:ut.fill},y.createElement(Xe.a,{style:ut.viewportView},y.createElement(Ke.a,{positionPersistence:lt},y.createElement(qe.a,{accessibilityTitle:tt,analytics:r,conversationIds:n,conversationPathPrefix:"/messages",createLocalApiErrorHandler:a,customCellClick:e._dmDrawerOnClick,fetchInbox:o,fetchInboxHistory:i,fetchInboxIfNeeded:c,fetchStatus:l,fetchUpdates:s,isRefreshing:u,renderEmptyDMInbox:e._renderEmptyDMInbox,renderStickyContent:e._renderPivot,updateLastSeenEventId:d,virtualScrollerCacheKey:"dmDrawerInbox"}))))})),v()(u()(e),"_renderEmptyDMInbox",(function(){return y.createElement(Ze.a,{buttonLink:"/messages/compose",buttonText:at,header:rt,message:nt,onImpression:e._handleEmptyDMInboxImpression})})),v()(u()(e),"_isExpanded",(function(){return e.props.visibility===X.a.EXPANDED})),v()(u()(e),"_dmDrawerOnClick",(function(t,r){(0,e.props.popOutConversation)(r),t.preventDefault()})),v()(u()(e),"_handleEmptyDMInboxImpression",(function(){e.props.analytics.scribe({component:"empty_message",action:"impression"})})),v()(u()(e),"_handleRequestsPivotClick",(function(){e.props.analytics.scribe({element:"requests_pivot",action:"click"})})),v()(u()(e),"_renderPivot",(function(){return e.props.allowUntrustedInbox?y.createElement(te.a,{style:ut.requestPivotContainer},y.createElement(Ye.a,{label:ot,link:"/messages/requests",onPress:e._handleRequestsPivotClick,renderRightContent:e._renderPivotBadge,withBottomBorder:!1})):null})),v()(u()(e),"_renderPivotBadge",(function(){var t=e.props.untrustedUnreadCount;return t>0?y.createElement(ne.a,{count:t,standalone:!0,truncatedCountFormatter:ct,unreadCountLabel:it}):null})),e}return l()(r,[{key:"componentDidUpdate",value:function(){this._isExpanded()&&Object($.a)()}},{key:"render",value:function(){var e=this.props,t=e.history,r=e.isUnread,n=e.isHeaderHighlighted,a=e.onDrawerOpen,o=e.triggerHeaderHighlight,i=this._isExpanded();return y.createElement(y.Fragment,null,y.createElement(Me,{hasNewMessages:r,history:t,isHighlighted:n,onDrawerOpen:a,triggerHighlight:o}),i&&this._renderExpandedInbox())}}]),r}(y.Component),ut=ie.a.create((function(e){return{fill:{flex:1,alignSelf:"stretch"},requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2},viewportView:Je(Je({},ie.a.absoluteFillObject),{},{overflowY:"auto"})}})),dt=$e(st),pt=r("YeIG"),ft="DMDrawer",ht=r("TnY3"),mt=r("0FVZ"),bt=r("Oe3h");function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var vt=function(e){p()(r,e);var t=gt(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),v()(u()(e),"state",{isHeaderHighlighted:!1,hasStartedInitialFetch:!1,unexpandedHeight:void 0}),v()(u()(e),"_handleLayout",(function(t){var r=t.nativeEvent.layout.height,n=e.state.unexpandedHeight;e._isExpanded()||void 0!==n||e.setState({unexpandedHeight:r})})),v()(u()(e),"_showDMDrawer",(function(){var t=e.props,r=t.conversations,n=t.visibility===X.a.CLOSED;return!e._isHideDMDrawerPath()&&!Object(pt.a)(r)&&!n})),v()(u()(e),"_isExpanded",(function(){return e.props.visibility===X.a.EXPANDED})),v()(u()(e),"_triggerHeaderHighlight",(function(){var t=e.state.isHeaderHighlighted;e._isExpanded()||t||e._headerHighlightTimeoutId||(e.setState({isHeaderHighlighted:!0}),e._headerHighlightTimeoutId=setTimeout((function(){e.setState({isHeaderHighlighted:!1}),e._headerHighlightTimeoutId=void 0}),3e3))})),v()(u()(e),"_handleDrawerOpen",(function(){e.state.isHeaderHighlighted&&(e.setState({isHeaderHighlighted:!1}),clearTimeout(e._headerHighlightTimeoutId),e._headerHighlightTimeoutId=void 0)})),v()(u()(e),"_isOnOcfFlow",(function(){return e.props.location.pathname.startsWith("/i/flow")})),v()(u()(e),"_isOnBirdwatchPage",(function(){return e.props.location.pathname.startsWith("/i/birdwatch")})),v()(u()(e),"_isHideDMDrawerPath",(function(){return e._isOnOcfFlow()||e._isOnBirdwatchPage()})),e}return l()(r,[{key:"componentWillUnmount",value:function(){clearTimeout(this._headerHighlightTimeoutId)}},{key:"componentDidUpdate",value:function(){this._loadInboxDataIfNeeded()}},{key:"componentDidMount",value:function(){this._loadInboxDataIfNeeded()}},{key:"render",value:function(){var e=this,t=this.props,r=t.history,n=t.location,o=t.perspective,i=t.poppedOutConversationId,c=t.width,l=this.state,s=l.isHeaderHighlighted,u=l.unexpandedHeight,d=this._isExpanded();return this._showDMDrawer()?y.createElement(mt.a.Drawer,null,y.createElement(bt.a,null,(function(t,l){return y.createElement(te.a,a()({ref:t()},l({style:[yt.root,{width:c}],testID:ft})),y.createElement(te.a,{onLayout:u?void 0:e._handleLayout,style:[yt.expandable,{height:u,maxHeight:u},d&&yt.expanded]},i?y.createElement(Be,{conversationId:i,history:r,isHeaderHighlighted:s,location:n,onDrawerOpen:e._handleDrawerOpen,perspective:o,triggerHeaderHighlight:e._triggerHeaderHighlight}):y.createElement(dt,{history:r,isHeaderHighlighted:s,onDrawerOpen:e._handleDrawerOpen,triggerHeaderHighlight:e._triggerHeaderHighlight})))}))):null}},{key:"_loadInboxDataIfNeeded",value:function(){var e=this.props,t=e.fetchInboxIfNeeded,r=e.createLocalApiErrorHandler,n=e.loadDrawerExperimentFromPersistence,a=e.loadDrawerVisibilityFromPersistence,o=this.state.hasStartedInitialFetch;this._isHideDMDrawerPath()||o||(a(),n(),t().catch(r()),this.setState({hasStartedInitialFetch:!0}))}}]),r}(y.PureComponent);v()(vt,"defaultProps",{width:E.a.dmDrawerWidth.max});var yt=ie.a.create((function(e){return{root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,boxShadow:e.boxShadows.medium,marginRight:e.spaces.medium,minWidth:E.a.dmDrawerWidth.min,maxWidth:E.a.dmDrawerWidth.max},expandable:{transition:"all 0.3s ease"},expanded:{maxHeight:E.a.dmDrawerHeight.expanded,height:"80vh"}}})),Et=C(vt);t.default=Object(ht.a)(Et)},"qS4/":function(e,t,r){"use strict";r("2G9S"),r("vrRf"),r("5BYb"),r("ho0z"),r("+KXO"),r("7x/C"),r("OZaJ"),r("DZ+c");var n=r("VrFO"),a=r.n(n),o=r("Y9Ll"),i=r.n(o),c=r("1Pcy"),l=r.n(c),s=r("5Yy7"),u=r.n(s),d=r("N+ot"),p=r.n(d),f=r("AuHH"),h=r.n(f),m=r("KEM+"),b=r.n(m),g=r("ERkP"),v=r("BUB3"),y=r("v6aA"),E=r("s14A"),O=(r("1t7P"),r("LW0h"),r("jwue"),r("jQ3i"),r("lTEL"),r("z84I"),r("6U7i"),r("daRM"),r("FtHn"),r("x4t0"),r("hBvt"),r("uFXj"),r("+oxZ"),r("kYxP"),r("MMRb")),_=r("0KEI"),w=r("hqKg"),I=r("AQOc"),C=r("G6rE"),x=r("oEGd"),D=function(e,t){return t.conversationId},P=Object(w.createSelector)(D,(function(e,t){return O.selectConversation(e,D(0,t))}),O.selectEntries,C.e.selectAll,(function(e,t){return!O.selectConversationIsRead(e,D(0,t))}),(function(e,t,r,n,a){return{conversation:t&&Object(I.a)(t.data,r,n),conversationId:e,unread:a}})),S={createLocalApiErrorHandler:Object(_.d)("DIRECT_MESSAGES_INBOX_ITEM"),leaveConversation:O.leaveConversation},j=Object(x.g)(P,S),M=r("aA19"),R=r("OhSZ"),H=r("t62R"),k=r("g54k"),T=Object(w.createSelector)(C.e.selectAll,(function(e,t){return t.entry}),k.b),N=Object(x.c)(T),F=r("zQEV"),L=N((function(e){var t=e.entry,r=e.entryType,n=e.perspective,a=e.users,o=Object(F.a)(t,r,n,a);return g.createElement(H.c,{color:"deepGray"},o)})),A=Object(w.createSelector)((function(e,t){return C.e.select(e,t.senderId)}),(function(e,t){return t.recipientId?C.e.select(e,t.recipientId):void 0}),(function(e,t){return{user:e,recipient:t}})),U=Object(x.c)(A),B=r("X/yg"),W=r("cTG8"),V=r("3XMw"),G=r.n(V),$=function(e){return g.createElement(G.a.I18NFormatMessage,{$i18n:"b3a2b11c"},g.createElement(H.c,null,e))},z=G.a.dedfd265;var q=G.a.a876e58b,K=G.a.bf584cd1,X=G.a.a9cc8cfd,Z=G.a.e20b65b0,Y=G.a.e5bfe07d,Q=G.a.b1a614fe,J=U((function(e){var t=e.entry,r=e.perspective,n=e.isGroupDM,a=e.user,o=void 0===a?{}:a,i=e.recipient,c=void 0===i?{}:i,l=t&&t.message_data;if(!l)return null;var s=l.attachment,u=s&&!!(s.video||s.photo||s.animated_gif||s.tweet||s.fleet||s.sticker||s.card),d=r===o.id_str,p=!(!u||!d)||!(!n||d),f=o.name,h=c.name,m=[p&&g.createElement(H.c,{key:"senderName"},$(f)," "),l&&l.text&&g.createElement(W.a,{displayTextRange:[0,l.text.length],entities:l.entities,key:"message",text:l.text,withMediaLinks:!0})];return s&&(s.tweet?m=p?function(e,t){return e?g.createElement(H.c,null,G.a.d5b762c8):g.createElement(G.a.I18NFormatMessage,{$i18n:"dfd2b3b9"},g.createElement(H.c,null,t))}(d,f):Q:s.fleet?m=function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"i005f1fd"},g.createElement(H.c,null,t),g.createElement(H.c,null,r||"")):g.createElement(G.a.I18NFormatMessage,{$i18n:"b35cee40"},g.createElement(H.c,null,r||""))}(d,h,l.text):s.video?m=Object(B.c)(s)?p?function(e,t){return e?g.createElement(H.c,null,G.a.h7033cac):g.createElement(G.a.I18NFormatMessage,{$i18n:"be5a9616"},g.createElement(H.c,null,t))}(d,f):z:p?function(e,t){return e?g.createElement(H.c,null,G.a.j7d81019):g.createElement(G.a.I18NFormatMessage,{$i18n:"eee2f120"},g.createElement(H.c,null,t))}(d,f):q:s.photo?m=p?function(e,t){return e?g.createElement(H.c,null,G.a.f80629ba):g.createElement(G.a.I18NFormatMessage,{$i18n:"c1e1f848"},g.createElement(H.c,null,t))}(d,f):K:s.animated_gif?m=p?function(e,t){return e?g.createElement(H.c,null,G.a.eb3d722e):g.createElement(G.a.I18NFormatMessage,{$i18n:"dc4b75a1"},g.createElement(H.c,null,t))}(d,f):X:s.sticker?m=p?function(e,t){return e?g.createElement(H.c,null,G.a.d30c2d4f):g.createElement(G.a.I18NFormatMessage,{$i18n:"c7e2464e"},g.createElement(H.c,null,t))}(d,f):Z:s.card&&(m=p?function(e,t){return e?g.createElement(H.c,null,G.a.db53c017):g.createElement(G.a.I18NFormatMessage,{$i18n:"hcbbbb34"},g.createElement(H.c,null,t))}(d,f):Y)),g.createElement(H.c,{color:"deepGray",numberOfLines:1},m)})),ee=r("uKEd"),te=function(e,t){return t.senderId?C.e.select(e,t.senderId):void 0},re=function(e,t){return Object(ee.n)(e,t.reactionEntry.message_id)},ne=function(e,t){var r=re(e,t);return r&&r.message_data&&C.e.select(e,r.message_data.sender_id)},ae=Object(x.e)((function(){return Object(w.createSelector)(te,re,ne,(function(e,t,r){return{reactedMessageEntry:t,reactingUser:e,messageUser:r}}))}),{}),oe=r("33Kz"),ie=ae((function(e){var t,r=e.isGroupDM,n=e.messageUser,a=e.perspective,o=e.reactionEntry,i=e.reactedMessageEntry,c=e.reactingUser,l=i&&i.message_data,s=l&&l.attachment,u=l&&l.text,d=n&&n.screen_name,p=a===(c&&c.id_str),f=c&&c.name,h=Object(oe.b)(o.reaction_key||"");return t=s&&s.tweet?r?function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"c4202784"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"b493a890"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,d,h):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"ca684bf5"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"h5797be5"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h):s&&s.video?r?function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"d1f8bdd9"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"d764af97"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,d,h):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"ab1cdfe2"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"f0cf1699"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h):s&&s.photo?r?function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"hec0fd4d"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"j55320de"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,d,h):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"jf27606a"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"cd110359"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h):s&&s.animated_gif?r?function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"e70dcc35"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"g1bf440b"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,d,h):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"b2da1bf8"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"g84c0421"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h):s&&s.card?r?function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"cd2e7c18"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"aee9e7fa"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,d,h):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"f9fb1cf6"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"f2bf910e"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h):u?r?function(e,t,r,n,a){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"i6cec545"},g.createElement(H.c,null,n),g.createElement(H.c,null,r),g.createElement(H.c,null,a)):g.createElement(G.a.I18NFormatMessage,{$i18n:"d6998baa"},g.createElement(H.c,null,t),g.createElement(H.c,null,n),g.createElement(H.c,null,r),g.createElement(H.c,null,a))}(p,f,h,d,u):function(e,t,r,n){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"cec676f3"},g.createElement(H.c,null,r),g.createElement(H.c,null,n)):g.createElement(G.a.I18NFormatMessage,{$i18n:"a2706f9a"},g.createElement(H.c,null,t),g.createElement(H.c,null,r),g.createElement(H.c,null,n))}(p,f,h,u):function(e,t,r){return e?g.createElement(G.a.I18NFormatMessage,{$i18n:"d6b15bbf"},g.createElement(H.c,null,r)):g.createElement(G.a.I18NFormatMessage,{$i18n:"ac0d4bc7"},g.createElement(H.c,null,t),g.createElement(H.c,null,r))}(p,f,h),g.createElement(H.c,{color:"deepGray",numberOfLines:1},t)})),ce=r("H4nC"),le=r("b9JY"),se=G.a.fb3ccb55,ue=function(e){var t=e.conversationType,r=e.entry,n=e.perspective;if(r.marked_as_spam)return g.createElement(H.c,{color:"deepGray",numberOfLines:1},se);if(Object(le.b)(r)){var a=r.message_data,o=(a=void 0===a?{}:a).sender_id,i=a.recipient_id;return g.createElement(J,{entry:r,isGroupDM:t===O.CONVERSATION_TYPE.GROUP,perspective:n,recipientId:i,senderId:o})}return Object(le.c)(r)?g.createElement(ie,{isGroupDM:t===O.CONVERSATION_TYPE.GROUP,perspective:n,reactionEntry:r,senderId:r.sender_id}):Object(le.a)(r)?g.createElement(L,{entry:r,entryType:r.type,perspective:n}):Object(le.d)(r)?g.createElement(ce.a,{entry:r,isCompact:!0}):null},de=r("wrlS"),pe=r("Myq3"),fe="conversation",he=r("MWbm"),me=r("Irs7"),be=r("0PHd"),ge=r("/yvb"),ve=r("eb3s"),ye=r("GBcw"),Ee=r("htQn"),Oe=r("5mJL"),_e=r("rHpw"),we=r("aWyx"),Ie=r("hiGS"),Ce=r("Lsrn"),xe=r("k/Ka");function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(xe.a)("svg",Pe(Pe({},e),{},{style:[Ce.a.root,e.style],viewBox:"0 0 24 24"}),g.createElement("g",null,g.createElement("path",{d:"M22.238 2.257c-.293-.293-.768-.293-1.06 0L2.52 20.917c-.293.292-.293.767 0 1.06.146.146.338.22.53.22s.384-.073.53-.22l18.658-18.66c.293-.293.293-.767 0-1.06zM2.986 17.82c.155 0 .312-.048.446-.148.112-.083 2.752-2.104 2.708-7.248-.02-2.16.643-3.98 1.913-5.266 1.093-1.107 2.577-1.72 4.18-1.727 1.325.006 2.562.42 3.578 1.195.137.104.297.153.455.153.227 0 .45-.102.598-.295.25-.33.188-.8-.142-1.052-1.278-.975-2.828-1.493-4.483-1.5h-.003c-2.008.008-3.87.78-5.248 2.173-1.536 1.551-2.368 3.8-2.348 6.332.037 4.33-2.02 5.967-2.103 6.03-.332.247-.4.718-.154 1.05.147.2.374.303.603.303zm16.844-7.382c.002-.246-.003-.487-.017-.723-.024-.414-.387-.74-.792-.706-.413.023-.728.378-.705.79.012.205.017.413.015.624-.024 2.868.785 4.765 1.526 5.896h-8.314c-.414 0-.75.336-.75.75s.336.75.75.75h3.522c-.1 1.48-1.323 2.66-2.828 2.66-1.003 0-1.913-.514-2.436-1.372-.214-.354-.675-.467-1.03-.25-.354.214-.467.675-.25 1.03.795 1.31 2.185 2.09 3.716 2.09 2.332 0 4.227-1.85 4.328-4.158h4.922c.32 0 .604-.206.707-.51.104-.305 0-.643-.255-.84-.087-.066-2.145-1.7-2.108-6.032z"})))};Se.metadata={width:24,height:24};var je=Se;function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var ke=G.a.gdf4b79f,Te=G.a.bbf83d83,Ne=G.a.d96cf7cd,Fe={component:"low_quality_timeline"},Le=function(e){var t=e.children;return g.createElement(he.a,{style:Ue.socialProofContainer},t)},Ae=function(e){u()(r,e);var t=He(r);function r(){var e;a()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),b()(l()(e),"_socialProofEnabled",de.b.isTrue("responsive_web_dm_health_inbox_request_cell_social_proof_enabled")),b()(l()(e),"state",{showConfirmation:!1}),b()(l()(e),"_renderSocialProof",(function(e){var t=e.social_proof;if(!t||0===t.length)return null;var r=t[0];switch(r.proof_type){case we.d.MUTUAL_FRIENDS:if(0===r.total)return null;var n=r.users.map((function(e){return e.profile_image_url_https})),a=r.users.map((function(e){return e.name}));return g.createElement(Le,null,g.createElement(be.a,{displayFacepileInline:!0,knownFollowersAvatarUrls:n,knownFollowersCount:r.total,knownFollowersNames:a}));default:return null}})),b()(l()(e),"_renderTrashcan",(function(){var t=e.props.conversationId;return g.createElement(g.Fragment,null,g.createElement(ge.a,{accessibilityLabel:Ne,borderColor:"transparent",icon:g.createElement(Ie.a,{style:Ue.trashcanIcon}),onPress:e._handleShowConfirmation,type:"destructiveText"}),e.state.showConfirmation?g.createElement(ve.a,{confirmButtonLabel:Ne,confirmButtonType:"destructive",headline:ke,onCancel:e._handleHideConfirmation,onConfirm:e._deleteConversation(t),text:Te}):null)})),b()(l()(e),"_renderTimestamp",(function(){var t=e.props.conversation;return g.createElement(g.Fragment,null,g.createElement(he.a,null,t?g.createElement(ye.a,{timestamp:Number(t.sort_timestamp)}):null,(null==t?void 0:t.notifications_disabled)?g.createElement(je,{style:Ue.notificationsDisabledIcon}):null))})),b()(l()(e),"_deleteConversation",(function(t){return function(){var r=e.props,n=r.analytics,a=r.createLocalApiErrorHandler,o=r.leaveConversation;e._handleHideConfirmation(),n.scribe(Re(Re({},Fe),{},{element:"thread",action:"delete_thread"})),o({conversationId:t}).catch(a({showToast:!0}))}})),b()(l()(e),"_handleHideConfirmation",(function(){e.setState({showConfirmation:!1})})),b()(l()(e),"_handleOnClick",(function(t){var r=e.props,n=r.conversationId;(0,r.onClick)(t,n)})),b()(l()(e),"_handleShowConfirmation",(function(t){var r=e.props.analytics;t.stopPropagation(),r.scribe(Re(Re({},Fe),{},{element:"accessory_trashcan",action:"click"})),e.setState({showConfirmation:!0})})),e}return i()(r,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props.conversation,n=null==r?void 0:r.conversation_id,a=null==r?void 0:r.last_read_event_id,o=null==r?void 0:r.sort_event_id,i=null==r?void 0:r.max_entry_id,c=e.conversation,l=null==c?void 0:c.conversation_id,s=null==c?void 0:c.last_read_event_id,u=null==c?void 0:c.sort_event_id,d=null==c?void 0:c.max_entry_id,p=this.props,f=p.filter,h=p.isActive,m=e.filter,b=e.isActive,g=this.state.showConfirmation,v=t.showConfirmation;return n!==l||a!==s||o!==u||i!==d||h!==b||g!==v||f!==m}},{key:"render",value:function(){var e=this.props,t=e.conversation,r=e.filter,n=e.isActive,a=e.isTertiaryInbox,o=e.perspective,i=e.unread,c=e.link,l=(null==t?void 0:t.entries)||[],s=Object(pe.a)(l,(function(e){return![we.b.MESSAGE_DELETE,we.b.REACTION_DELETE,we.b.MESSAGE_MARK_AS_SPAM,we.b.MESSAGE_MARK_AS_NOT_SPAM].includes(e.type)})),u=[Ue.root,Ue.bottomBorder,i&&Ue.unread];if(!t||!r(t))return null;var d=!t.trusted&&this._socialProofEnabled;return g.createElement(Ee.a,{accessibilityRole:"tab",accessibilityState:{selected:n},link:{pathname:c,anchorless:!0},onPress:this._handleOnClick,style:u,testID:fe},g.createElement(Oe.a,{avatarCell:g.createElement(M.a,{conversation:t,perspective:o})},g.createElement(he.a,{style:Ue.bodyColumn},g.createElement(he.a,{style:Ue.titleContainer},g.createElement(R.b,{conversation:t,perspective:o}),g.createElement(he.a,{style:Ue.snippet},s?g.createElement(ue,{conversationType:t.type,entry:s,perspective:o}):null),d?this._renderSocialProof(t):null),a?this._renderTrashcan():this._renderTimestamp())))}}]),r}(g.Component);b()(Ae,"defaultProps",{isActive:!1,filter:function(e){return!0},unread:!1});var Ue=_e.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.small,width:"100%"},bottomBorder:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},bodyColumn:{flexDirection:"row"},titleContainer:{flex:1},notificationsDisabledIcon:{alignSelf:"flex-end",color:e.colors.deepGray,paddingTop:e.spaces.xxSmall},trashcanIcon:{color:e.colors.red},snippet:{maxHeight:e.spaces.xLarge,overflow:"hidden"},unread:{backgroundColor:e.colors.unreadCellBackground},socialProofContainer:{marginTop:e.spaces.xxSmall}}})),Be=Object(me.a)(j(Ae),{page:"messages",section:"inbox"}),We=r("dwig"),Ve=r("v//M"),Ge=r("QB0K"),$e=r("Avzu"),ze=r("FRNI");function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var Ke=G.a.dabdea6b,Xe=G.a.f325afc3,Ze=function(e){u()(r,e);var t=qe(r);function r(){return a()(this,r),t.apply(this,arguments)}return i()(r,[{key:"render",value:function(){return g.createElement(Ge.a,{accessibilityLabel:Ke,href:"/messages/compose",icon:g.createElement($e.a,null),label:Ke,scribeComponent:"floating_dm_button",shortLabel:Xe,testID:ze.a.message})}}]),r}(g.PureComponent),Ye=r("VwDm"),Qe=r("VPAj");function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var tt=et(et({},r("IRWI").a),{},{initialScrollHeadroom:Object(Qe.a)(0),scrollHeadroom:Object(Qe.a)(0),pinToTopWhenAtTop:!0}),rt=r("tI3i"),nt=r.n(rt),at=r("TEoO"),ot=r("yoO3"),it=r("IG4P"),ct=r("GSsg"),lt=r("2g+p"),st=r("6OUF"),ut=r("mw9i"),dt=r("VY6S"),pt=r("+d3d");function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var ht=function(e){return e},mt=G.a.a66ac766,bt=G.a.fe61929d,gt=function(e){u()(r,e);var t=ft(r);function r(e,n){var o;return a()(this,r),o=t.call(this,e,n),b()(l()(o),"state",{filterQuery:""}),b()(l()(o),"_render",(function(){var e=o.props,t=e.accessibilityTitle,r=e.conversationIds,n=e.footer,a=e.isRefreshing,i=e.renderEmptyDMInbox,c=e.renderStickyContent,l=e.virtualScrollerCacheKey;return g.createElement(g.Fragment,null,c?c():null,o._enableSearchInbox?g.createElement(he.a,{style:vt.searchInput},g.createElement(st.a,{Icon:Ye.a,onChange:o._handleSearchChange,onClear:o._handleSearchClear,onFocus:o._handleSearchFocus,placeholder:bt,withClearButton:!0})):null,g.createElement(E.a,null,g.createElement(it.a,{isRefreshing:a,onRefresh:o._handlePullToRefresh},l&&r?g.createElement(at.a,{accessibilityRole:"tablist",accessibilityTitle:t,anchoring:tt,assumedItemHeight:100,cacheKey:l,footer:n,identityFunction:ht,items:r,noItemsRenderer:i,onNearEnd:o._handleNearEnd,renderer:o._renderInboxItem(o.state.filterQuery)}):null)))})),b()(l()(o),"_handleNearEnd",(function(){o.state.filterQuery||o._handleHistoryRequest()})),b()(l()(o),"_handleSearchChangeInner",(function(e){var t=o.props.analytics;o.setState({filterQuery:e.toLowerCase()}),t.scribe({element:"thread",action:"search",data:{event_value:o.state.filterQuery.length}})})),b()(l()(o),"_handleSearchChangeDebounced",Object(dt.a)(o._handleSearchChangeInner,200)),b()(l()(o),"_handleSearchChange",(function(e){var t=e.currentTarget.value;return o._handleSearchChangeDebounced(t)})),b()(l()(o),"_handleSearchClear",(function(){return o._handleSearchChangeInner("")})),b()(l()(o),"_handleSearchFocus",(function(){o.props.conversationIds&&o.props.conversationIds.length<30&&o._handleHistoryRequest()})),b()(l()(o),"_renderInboxItem",(function(e){return function(t){var r=o.context.loggedInUserId,n=o.props,a=n.conversationPathPrefix,i=n.isTertiaryInbox,c=o._filterConversation(e),l="".concat(a,"/").concat(t);return nt()(!!r,"loggedInUserId must be defined"),g.createElement(v.a,{exact:!1,path:l},(function(e){return g.createElement(Be,{conversationId:t,filter:c,isActive:e,isTertiaryInbox:i,key:t,link:l,onClick:o._handleConversationClick,perspective:r})}))}})),b()(l()(o),"_filterConversation",(function(e){return function(e){var t=o.state.filterQuery;if(!t)return!0;var r=o.context.loggedInUserId,n=Object.keys(e.participants),a="GROUP_DM"===e.type&&e.name&&e.name.toLowerCase().indexOf(t)>-1,i=n.some((function(a){var i=e.participants[a],c=r===a,l=1===n.length&&c,s=i&&i.user&&!c;return!(!l&&!s)&&o._userMatchesQuery(i.user.screen_name,i.user.name,t)}));return!(!a&&!i)}})),b()(l()(o),"_handleFetchInitialWrapper",(function(){o._handleFetchInitial()})),b()(l()(o),"_handleFetchInitial",(function(){var e=o.props,t=e.createLocalApiErrorHandler,r=e.fetchInboxIfNeeded,n=e.fetchUpdates;return r().then(o._updateLastSeenEventId,t()).then((function(){o._updatePolling.start()})).then((function(){return n().catch(t())}))})),b()(l()(o),"_handleConversationClick",(function(e,t){var r=o.props,n=r.customCellClick;r.analytics.scribe({element:"thread",action:"click",data:{event_value:o.state.filterQuery.length}}),n&&n(e,t)})),b()(l()(o),"_handleEmptyDMInboxImpression",(function(){o.props.analytics.scribe({component:"empty_message",action:"impression"})})),b()(l()(o),"_handlePullToRefresh",(function(){var e=o.props,t=e.createLocalApiErrorHandler;(0,e.fetchInbox)().then(o._updateLastSeenEventId,t())})),b()(l()(o),"_updateLastSeenEventIdIfActive",(function(){if("background"!==lt.a.currentState)return o._updateLastSeenEventId()})),b()(l()(o),"_updateLastSeenEventId",(function(){var e=o.props,t=e.createLocalApiErrorHandler;return(0,e.updateLastSeenEventId)().catch(t())})),o._fab=g.createElement(Ze,null),o._enableSearchInbox=!!e.withDmSearch&&de.b.isTrue("responsive_web_search_dms_enabled"),o}return i()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.createLocalApiErrorHandler,n=t.fetchInboxHistory,a=t.fetchUpdates;return this._updatePolling=new ct.a((function(){a().then(e._updateLastSeenEventIdIfActive,r())}),{interval:8e3}),this._handleHistoryRequest=Object(pt.a)((function(){n.apply(void 0,arguments).catch(r())}),1e3),this._handleFetchInitial()}},{key:"componentWillUnmount",value:function(){this._updatePolling.stop()}},{key:"render",value:function(){return g.createElement(ot.a,null,g.createElement(We.a,{component:ut.a,fab:this._fab,style:vt.root},g.createElement(Ve.a,{accessibilityLabel:mt,fetchStatus:this.props.fetchStatus,onRequestRetry:this._handleFetchInitialWrapper,render:this._render})))}},{key:"_userMatchesQuery",value:function(e,t,r){return e&&e.toLowerCase().indexOf(r)>-1||t&&t.toLowerCase().indexOf(r)>-1}}]),r}(g.Component);b()(gt,"contextType",y.a),b()(gt,"defaultProps",{conversationIds:[],isTertiaryInbox:!1,withDmSearch:!1});var vt=_e.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground,flexGrow:1},searchInput:{backgroundColor:e.colors.cellBackground,borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:"1px",padding:e.spaces.xSmall,zIndex:1}}}));t.a=gt}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web-legacy/loader.DMDrawer.54f57605.js.map